<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RootMargin è¯¦è§£ Demo</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 20px;
    }

    .tip {
      margin: 20px 0;
      padding: 15px;
      background: #e3f2fd;
      border: 1px solid #2196F3;
      border-radius: 4px;
      color: #1565C0;
    }

    /* ä¸»è¦æ¼”ç¤ºåŒºåŸŸ */
    .main-demo {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 20px;
      margin-bottom: 40px;
    }

    /* æ§åˆ¶é¢æ¿ */
    .control-panel {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 20px;
      height: fit-content;
    }

    .control-panel h3 {
      margin: 0 0 15px 0;
      color: #333;
    }

    .control-group {
      margin-bottom: 20px;
    }

    .control-group label {
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
      color: #666;
    }

    .control-group input[type="range"] {
      width: 100%;
      margin-bottom: 5px;
    }

    .value-display {
      font-size: 12px;
      color: #999;
      text-align: right;
    }

    .margin-preview {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 4px;
      font-family: monospace;
      font-size: 14px;
      text-align: center;
      color: #333;
    }

    button {
      width: 100%;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
    }

    button:hover {
      background-color: #45a049;
    }

    /* æ¼”ç¤ºå®¹å™¨ */
    .demo-container {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .scroll-container {
      height: 500px;
      overflow-y: auto;
      border: 3px solid #333;
      background: #fafafa;
      position: relative;
      border-radius: 4px;
    }

    /* è§†å£è¾¹ç•Œï¼ˆåŸå§‹ï¼‰ */
    .viewport-boundary {
      position: sticky;
      top: 0;
      left: 0;
      right: 0;
      height: 100%;
      border: 3px solid #2196F3;
      background: rgba(33, 150, 243, 0.05);
      pointer-events: none;
      z-index: 2;
    }

    .viewport-label {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #2196F3;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
    }

    /* RootMargin è¾¹ç•Œï¼ˆæ‰©å±•åï¼‰ */
    .rootmargin-boundary {
      position: absolute;
      border: 3px dashed #f44336;
      background: rgba(244, 67, 54, 0.05);
      pointer-events: none;
      z-index: 1;
      transition: all 0.3s ease;
    }

    .rootmargin-label {
      position: absolute;
      top: -25px;
      left: 10px;
      background: #f44336;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
    }

    /* ç›®æ ‡å…ƒç´  */
    .target-element {
      width: 200px;
      height: 150px;
      margin: 400px auto;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      transition: all 0.3s ease;
      position: relative;
    }

    .target-element.intersecting {
      transform: scale(1.1);
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

    .status-badge {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: #4CAF50;
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .target-element.intersecting .status-badge {
      opacity: 1;
    }

    /* ç¤ºä¾‹å±•ç¤º */
    .examples-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 40px;
    }

    .example-card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .example-card h3 {
      margin: 0 0 15px 0;
      color: #4CAF50;
    }

    .example-visual {
      height: 200px;
      border: 2px solid #ddd;
      position: relative;
      margin-bottom: 15px;
      background: #fafafa;
      overflow: hidden;
    }

    .mini-viewport {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60%;
      height: 60%;
      border: 2px solid #2196F3;
      background: rgba(33, 150, 243, 0.1);
    }

    .mini-rootmargin {
      position: absolute;
      border: 2px dashed #f44336;
      background: rgba(244, 67, 54, 0.05);
    }

    .mini-element {
      position: absolute;
      width: 40px;
      height: 40px;
      background: #9c27b0;
      border-radius: 4px;
      transition: all 0.3s ease;
    }

    .example-desc {
      font-size: 14px;
      color: #666;
      line-height: 1.5;
    }

    .code-snippet {
      margin-top: 10px;
      padding: 10px;
      background: #f5f5f5;
      border-radius: 4px;
      font-family: monospace;
      font-size: 12px;
      color: #333;
    }

    /* è¯´æ˜éƒ¨åˆ† */
    .explanation {
      margin-top: 40px;
      padding: 30px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .explanation h2 {
      color: #333;
      margin-bottom: 20px;
    }

    .explanation ul {
      line-height: 1.8;
      color: #666;
    }

    .explanation li {
      margin-bottom: 10px;
    }

    /* æ–¹å‘æŒ‡ç¤ºå™¨ */
    .direction-indicators {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
    }

    .direction-arrow {
      position: absolute;
      font-size: 20px;
      color: #f44336;
      font-weight: bold;
    }

    .direction-arrow.top {
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
    }

    .direction-arrow.right {
      right: -5px;
      top: 50%;
      transform: translateY(-50%);
    }

    .direction-arrow.bottom {
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
    }

    .direction-arrow.left {
      left: -5px;
      top: 50%;
      transform: translateY(-50%);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>RootMargin è¯¦è§£ - æ‰©å±•æ£€æµ‹è¾¹ç•Œ</h1>
    
    <div class="tip">
      ğŸ’¡ <strong>RootMargin çš„ä½œç”¨ï¼š</strong>æ‰©å±•æˆ–æ”¶ç¼©æ ¹å…ƒç´ ï¼ˆè§†å£ï¼‰çš„è¾¹ç•Œï¼Œè®©å…ƒç´ åœ¨å®é™…è¿›å…¥è§†å£ä¹‹å‰æˆ–ä¹‹åè§¦å‘ã€‚
      å¯ä»¥ç†è§£ä¸ºç»™è§†å£åŠ äº†ä¸€ä¸ª"å¤–è¾¹è·"ã€‚
    </div>

    <div class="main-demo">
      <!-- æ§åˆ¶é¢æ¿ -->
      <div class="control-panel">
        <h3>è°ƒæ•´ RootMargin</h3>
        
        <div class="control-group">
          <label>ä¸Šè¾¹è· (Top)</label>
          <input type="range" id="marginTop" min="-200" max="200" value="0">
          <div class="value-display">å€¼: <span id="topValue">0px</span></div>
        </div>
        
        <div class="control-group">
          <label>å³è¾¹è· (Right)</label>
          <input type="range" id="marginRight" min="-200" max="200" value="0">
          <div class="value-display">å€¼: <span id="rightValue">0px</span></div>
        </div>
        
        <div class="control-group">
          <label>ä¸‹è¾¹è· (Bottom)</label>
          <input type="range" id="marginBottom" min="-200" max="200" value="0">
          <div class="value-display">å€¼: <span id="bottomValue">0px</span></div>
        </div>
        
        <div class="control-group">
          <label>å·¦è¾¹è· (Left)</label>
          <input type="range" id="marginLeft" min="-200" max="200" value="0">
          <div class="value-display">å€¼: <span id="leftValue">0px</span></div>
        </div>
        
        <div class="margin-preview">
          rootMargin:<br>
          "<span id="marginString">0px 0px 0px 0px</span>"
        </div>
        
        <button onclick="applyRootMargin()">åº”ç”¨è®¾ç½®</button>
        <button onclick="resetRootMargin()" style="background-color: #666;">é‡ç½®</button>
      </div>

      <!-- æ¼”ç¤ºåŒºåŸŸ -->
      <div class="demo-container">
        <h3>å¯è§†åŒ–æ¼”ç¤º</h3>
        <div class="scroll-container" id="scrollContainer">
          <!-- åŸå§‹è§†å£è¾¹ç•Œ -->
          <div class="viewport-boundary">
            <div class="viewport-label">åŸå§‹è§†å£</div>
          </div>
          
          <!-- RootMargin è¾¹ç•Œ -->
          <div class="rootmargin-boundary" id="rootMarginBoundary">
            <div class="rootmargin-label">æ£€æµ‹è¾¹ç•Œ (è§†å£ + rootMargin)</div>
            <div class="direction-indicators">
              <div class="direction-arrow top" id="arrowTop">â†‘</div>
              <div class="direction-arrow right" id="arrowRight">â†’</div>
              <div class="direction-arrow bottom" id="arrowBottom">â†“</div>
              <div class="direction-arrow left" id="arrowLeft">â†</div>
            </div>
          </div>
          
          <!-- ç›®æ ‡å…ƒç´  -->
          <div class="target-element" id="targetElement">
            <div class="status-badge">æ£€æµ‹åˆ°ï¼</div>
            ç›®æ ‡å…ƒç´ 
          </div>
        </div>
        
        <p style="margin-top: 15px; color: #666; font-size: 14px;">
          ğŸ”µ è“è‰²å®çº¿æ¡† = åŸå§‹è§†å£è¾¹ç•Œ<br>
          ğŸ”´ çº¢è‰²è™šçº¿æ¡† = å®é™…æ£€æµ‹è¾¹ç•Œï¼ˆåº”ç”¨ rootMargin åï¼‰
        </p>
      </div>
    </div>

    <!-- å¸¸è§ç”¨ä¾‹ç¤ºä¾‹ -->
    <div class="examples-grid">
      <div class="example-card">
        <h3>æå‰åŠ è½½ï¼ˆæ­£å€¼ï¼‰</h3>
        <div class="example-visual">
          <div class="mini-viewport"></div>
          <div class="mini-rootmargin" style="top: 10%; left: 10%; right: 10%; bottom: 10%;"></div>
          <div class="mini-element" style="bottom: 5%; left: 50%; transform: translateX(-50%);"></div>
        </div>
        <div class="code-snippet">rootMargin: "200px"</div>
        <p class="example-desc">
          ä½¿ç”¨æ­£å€¼æ‰©å±•æ£€æµ‹è¾¹ç•Œï¼Œå…ƒç´ è¿˜æœªè¿›å…¥è§†å£å°±èƒ½è¢«æ£€æµ‹åˆ°ã€‚
          é€‚åˆå›¾ç‰‡æ‡’åŠ è½½ï¼Œæå‰åŠ è½½å³å°†è¿›å…¥è§†å£çš„å›¾ç‰‡ã€‚
        </p>
      </div>

      <div class="example-card">
        <h3>å»¶è¿Ÿè§¦å‘ï¼ˆè´Ÿå€¼ï¼‰</h3>
        <div class="example-visual">
          <div class="mini-viewport"></div>
          <div class="mini-rootmargin" style="top: 35%; left: 35%; right: 35%; bottom: 35%;"></div>
          <div class="mini-element" style="top: 45%; left: 50%; transform: translate(-50%, -50%);"></div>
        </div>
        <div class="code-snippet">rootMargin: "-100px"</div>
        <p class="example-desc">
          ä½¿ç”¨è´Ÿå€¼æ”¶ç¼©æ£€æµ‹è¾¹ç•Œï¼Œå…ƒç´ éœ€è¦æ›´æ·±å…¥è§†å£æ‰è¢«æ£€æµ‹åˆ°ã€‚
          é€‚åˆç¡®ä¿å…ƒç´ çœŸæ­£è¢«ç”¨æˆ·å…³æ³¨æ—¶æ‰è§¦å‘ã€‚
        </p>
      </div>

      <div class="example-card">
        <h3>æ°´å¹³æ»šåŠ¨ä¼˜åŒ–</h3>
        <div class="example-visual">
          <div class="mini-viewport"></div>
          <div class="mini-rootmargin" style="top: 20%; left: -10%; right: -10%; bottom: 20%;"></div>
          <div class="mini-element" style="top: 50%; right: -15%; transform: translateY(-50%);"></div>
        </div>
        <div class="code-snippet">rootMargin: "0px 200px"</div>
        <p class="example-desc">
          åªåœ¨æ°´å¹³æ–¹å‘æ‰©å±•è¾¹ç•Œï¼Œé€‚åˆæ¨ªå‘æ»šåŠ¨çš„åœºæ™¯ã€‚
          å¦‚è½®æ’­å›¾é¢„åŠ è½½ä¸‹ä¸€å¼ å›¾ç‰‡ã€‚
        </p>
      </div>

      <div class="example-card">
        <h3>åº•éƒ¨æ— é™æ»šåŠ¨</h3>
        <div class="example-visual">
          <div class="mini-viewport"></div>
          <div class="mini-rootmargin" style="top: 20%; left: 20%; right: 20%; bottom: -30%;"></div>
          <div class="mini-element" style="bottom: -20%; left: 50%; transform: translateX(-50%);"></div>
        </div>
        <div class="code-snippet">rootMargin: "0px 0px 300px 0px"</div>
        <p class="example-desc">
          åªåœ¨åº•éƒ¨æ‰©å±•è¾¹ç•Œï¼Œå½“æ»šåŠ¨æ¥è¿‘åº•éƒ¨æ—¶è§¦å‘ã€‚
          å®Œç¾é€‚ç”¨äºæ— é™æ»šåŠ¨åŠ è½½æ›´å¤šå†…å®¹ã€‚
        </p>
      </div>
    </div>

    <!-- è¯¦ç»†è¯´æ˜ -->
    <div class="explanation">
      <h2>ğŸ“– RootMargin è¯¦ç»†è¯´æ˜</h2>
      
      <h3>è¯­æ³•æ ¼å¼</h3>
      <ul>
        <li><strong>å®Œæ•´æ ¼å¼ï¼š</strong><code>"top right bottom left"</code> - ç±»ä¼¼ CSS margin</li>
        <li><strong>ä¸¤ä¸ªå€¼ï¼š</strong><code>"vertical horizontal"</code> - ä¸Šä¸‹ç›¸åŒï¼Œå·¦å³ç›¸åŒ</li>
        <li><strong>ä¸€ä¸ªå€¼ï¼š</strong><code>"all"</code> - å››ä¸ªæ–¹å‘ç›¸åŒ</li>
        <li><strong>å•ä½ï¼š</strong>å¿…é¡»åŒ…å«å•ä½ï¼ˆpx æˆ– %ï¼‰ï¼Œä¸èƒ½åªå†™æ•°å­—</li>
      </ul>

      <h3>æ­£å€¼ vs è´Ÿå€¼</h3>
      <ul>
        <li><strong>æ­£å€¼ï¼ˆå¦‚ "100px"ï¼‰ï¼š</strong>æ‰©å±•æ£€æµ‹è¾¹ç•Œï¼Œå…ƒç´ æå‰è¢«æ£€æµ‹åˆ°</li>
        <li><strong>è´Ÿå€¼ï¼ˆå¦‚ "-100px"ï¼‰ï¼š</strong>æ”¶ç¼©æ£€æµ‹è¾¹ç•Œï¼Œå…ƒç´ éœ€è¦æ›´æ·±å…¥æ‰è¢«æ£€æµ‹åˆ°</li>
      </ul>

      <h3>å®é™…åº”ç”¨åœºæ™¯</h3>
      <ul>
        <li><strong>å›¾ç‰‡æ‡’åŠ è½½ï¼š</strong>ä½¿ç”¨æ­£å€¼ï¼ˆå¦‚ "200px"ï¼‰æå‰åŠ è½½å³å°†è¿›å…¥è§†å£çš„å›¾ç‰‡</li>
        <li><strong>æ— é™æ»šåŠ¨ï¼š</strong>åº•éƒ¨ä½¿ç”¨æ­£å€¼ï¼ˆå¦‚ "0px 0px 300px 0px"ï¼‰æå‰è§¦å‘åŠ è½½</li>
        <li><strong>æ•°æ®ç»Ÿè®¡ï¼š</strong>ä½¿ç”¨è´Ÿå€¼ï¼ˆå¦‚ "-50px"ï¼‰ç¡®ä¿å…ƒç´ çœŸæ­£è¢«çœ‹åˆ°</li>
        <li><strong>åŠ¨ç”»è§¦å‘ï¼š</strong>æ ¹æ®éœ€è¦è°ƒæ•´ï¼Œè®©åŠ¨ç”»åœ¨åˆé€‚çš„æ—¶æœºå¼€å§‹</li>
      </ul>

      <h3>æ³¨æ„äº‹é¡¹</h3>
      <ul>
        <li>rootMargin ä¸ä¼šæ”¹å˜å…ƒç´ çš„å®é™…ä½ç½®ï¼Œåªæ”¹å˜æ£€æµ‹è¾¹ç•Œ</li>
        <li>å¯ä»¥ç»„åˆä½¿ç”¨ rootMargin å’Œ threshold å®ç°å¤æ‚çš„æ£€æµ‹é€»è¾‘</li>
        <li>ç™¾åˆ†æ¯”å•ä½æ˜¯ç›¸å¯¹äºæ ¹å…ƒç´ çš„å°ºå¯¸è®¡ç®—çš„</li>
      </ul>
    </div>
  </div>

  <script>
    let observer = null;
    const targetElement = document.getElementById('targetElement');
    const scrollContainer = document.getElementById('scrollContainer');
    const rootMarginBoundary = document.getElementById('rootMarginBoundary');

    // åˆå§‹åŒ–
    function init() {
      createObserver();
      
      // ç»‘å®šæ»‘å—äº‹ä»¶
      ['Top', 'Right', 'Bottom', 'Left'].forEach(side => {
        const slider = document.getElementById(`margin${side}`);
        const display = document.getElementById(`${side.toLowerCase()}Value`);
        
        slider.addEventListener('input', (e) => {
          display.textContent = `${e.target.value}px`;
          updateMarginString();
          updateBoundaryVisual();
        });
      });
    }

    // åˆ›å»ºè§‚å¯Ÿå™¨
    function createObserver(rootMargin = '0px 0px 0px 0px') {
      if (observer) {
        observer.disconnect();
      }

      observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('intersecting');
          } else {
            entry.target.classList.remove('intersecting');
          }
        });
      }, {
        root: scrollContainer,
        rootMargin: rootMargin,
        threshold: 0
      });

      observer.observe(targetElement);
    }

    // åº”ç”¨ RootMargin
    function applyRootMargin() {
      const marginString = document.getElementById('marginString').textContent;
      createObserver(marginString);
    }

    // é‡ç½®
    function resetRootMargin() {
      ['Top', 'Right', 'Bottom', 'Left'].forEach(side => {
        document.getElementById(`margin${side}`).value = 0;
        document.getElementById(`${side.toLowerCase()}Value`).textContent = '0px';
      });
      updateMarginString();
      updateBoundaryVisual();
      applyRootMargin();
    }

    // æ›´æ–° margin å­—ç¬¦ä¸²
    function updateMarginString() {
      const values = ['Top', 'Right', 'Bottom', 'Left'].map(side => 
        document.getElementById(`margin${side}`).value + 'px'
      );
      document.getElementById('marginString').textContent = values.join(' ');
    }

    // æ›´æ–°è¾¹ç•Œå¯è§†åŒ–
    function updateBoundaryVisual() {
      const margins = ['Top', 'Right', 'Bottom', 'Left'].map(side => 
        parseInt(document.getElementById(`margin${side}`).value)
      );
      
      // æ›´æ–°è¾¹ç•Œä½ç½®
      rootMarginBoundary.style.top = `${-margins[0]}px`;
      rootMarginBoundary.style.right = `${-margins[1]}px`;
      rootMarginBoundary.style.bottom = `${-margins[2]}px`;
      rootMarginBoundary.style.left = `${-margins[3]}px`;
      
      // æ›´æ–°ç®­å¤´æ˜¾ç¤º
      ['Top', 'Right', 'Bottom', 'Left'].forEach((side, index) => {
        const arrow = document.getElementById(`arrow${side}`);
        const value = margins[index];
        
        if (value > 0) {
          arrow.style.display = 'block';
          arrow.style.color = '#4CAF50';
        } else if (value < 0) {
          arrow.style.display = 'block';
          arrow.style.color = '#f44336';
        } else {
          arrow.style.display = 'none';
        }
      });
    }

    // åˆå§‹åŒ–
    init();
  </script>
</body>
</html>
